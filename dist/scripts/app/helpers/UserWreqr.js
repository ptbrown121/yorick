define(["jquery","underscore","parse","backbone","marionette","../collections/Users"],function(e,r,n,t,s,u){return new(t.Model.extend({initialize:function(){var e=this;e.channel=t.Wreqr.radio.channel("user"),e.users=new u,t.Wreqr.radio.reqres.setHandler("user","get",function(r){return e.users.get(r)}),t.Wreqr.radio.reqres.setHandler("user","all",function(){var r=n.User.current().get("storytellerinterface");if(n.User.current().get("admininterface")||r)return e.users;var t=new u;return t.models.push(e.users.get(n.User.current().id)),t})},get_users:function(){var e=e||{};return r.defaults(e,{update:!0}),this.users.fetch()},get_latest_patronage:function(e){var r;return new n.Query("Patronage").equalTo("owner",e).descending("expiresOn").first().then(function(e){r=e}).always(function(){return n.Promise.as(r)})}}))});