define(["underscore","jquery","backbone","text!../templates/referendums-list.html","parse","../collections/Referendums","../helpers/PromiseFailReport"],function(e,t,i,r,n,l,s){return i.View.extend({initialize:function(){e.bindAll(this,"render","register"),this.collection=new l,this.listenTo(this.collection,"add remove reset",this.render)},register:function(t,i){var r=this;if(t=t||"#referendum/<%= referendum_id %>",e.eq(t,r.base_url)||(r.base_url=t,!0),i=i||function(){},!e.eq(i,r.filter)){var l=[],o=new n.Query("Referendum");return o.select("id","name","portrait","shortdescription","order"),o.include("portrait"),i(o),o.each(function(e){l.push(e)}).then(function(){r.collection.reset(l)}).fail(s)}return n.Promise.as([])},events:{"click .referendum-listing":"clicked"},clicked:function(i){i.preventDefault(),t.mobile.loading("show");var r=t(i.currentTarget).attr("backendId"),n=e.template(this.base_url)({referendum_id:r});window.location.hash=n},render:function(){return this.template=e.template(r)({collection:this.collection.models}),this.$el.find("div[role='referendums-list']").html(this.template),this.$el.enhanceWithin(),this}})});